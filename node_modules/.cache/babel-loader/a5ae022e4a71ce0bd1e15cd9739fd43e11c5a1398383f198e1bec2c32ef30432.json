{"ast":null,"code":"import { ethers } from \"ethers\";\n\n/** Function to get ERC-20 Approvals */\nexport async function getERC20Approvals(tokenContracts, ownerAddress, provider) {\n  const abi = [\"function allowance(address owner, address spender) view returns (uint256)\"];\n  let approvals = [];\n\n  // ‚úÖ Use a valid spender address (avoid ENS resolution issues)\n  const spenderAddresses = [\"0x000000000000000000000000000000000000dead\" // Use a dummy non-zero address\n  ];\n\n  // ‚úÖ Ensure owner address is checksummed\n  const owner = ethers.utils.getAddress(ownerAddress);\n\n  // ‚úÖ Get a signer from the provider\n  const signer = provider.getSigner();\n  for (let tokenAddress of tokenContracts) {\n    try {\n      const contract = new ethers.Contract(ethers.utils.getAddress(tokenAddress),\n      // Ensure checksum format\n      abi, signer // Use signer instead of undefined variable\n      );\n      for (let spender of spenderAddresses) {\n        console.log(`üõ†Ô∏è Checking allowance for spender: ${spender}`);\n        try {\n          const allowance = await contract.allowance(owner, spender);\n          if (allowance > 0) {\n            approvals.push({\n              contract: tokenAddress,\n              type: \"ERC-20\",\n              spender: spender,\n              amount: allowance.toString()\n            });\n          }\n        } catch (error) {\n          console.error(`‚ùå Error fetching allowance for spender: ${spender}`, error);\n        }\n      }\n    } catch (error) {\n      console.error(`‚ùå Error creating contract for token: ${tokenAddress}`, error);\n    }\n  }\n  console.log(\"‚úÖ ERC-20 Approvals Fetched:\", approvals);\n  return approvals;\n}","map":{"version":3,"names":["ethers","getERC20Approvals","tokenContracts","ownerAddress","provider","abi","approvals","spenderAddresses","owner","utils","getAddress","signer","getSigner","tokenAddress","contract","Contract","spender","console","log","allowance","push","type","amount","toString","error"],"sources":["/Users/markemery/mini.revoke/src/utils/erc20Approvals.js"],"sourcesContent":["import { ethers } from \"ethers\";\n\n/** Function to get ERC-20 Approvals */\nexport async function getERC20Approvals(tokenContracts, ownerAddress, provider) {\n    const abi = [\"function allowance(address owner, address spender) view returns (uint256)\"];\n\n    let approvals = [];\n\n    // ‚úÖ Use a valid spender address (avoid ENS resolution issues)\n    const spenderAddresses = [\n        \"0x000000000000000000000000000000000000dead\", // Use a dummy non-zero address\n    ];\n\n    // ‚úÖ Ensure owner address is checksummed\n    const owner = ethers.utils.getAddress(ownerAddress);\n\n    // ‚úÖ Get a signer from the provider\n    const signer = provider.getSigner();\n\n    for (let tokenAddress of tokenContracts) {\n        try {\n            const contract = new ethers.Contract(\n                ethers.utils.getAddress(tokenAddress), // Ensure checksum format\n                abi,\n                signer // Use signer instead of undefined variable\n            );\n\n            for (let spender of spenderAddresses) {\n                console.log(`üõ†Ô∏è Checking allowance for spender: ${spender}`);\n\n                try {\n                    const allowance = await contract.allowance(owner, spender);\n                    if (allowance > 0) {\n                        approvals.push({\n                            contract: tokenAddress,\n                            type: \"ERC-20\",\n                            spender: spender,\n                            amount: allowance.toString(),\n                        });\n                    }\n                } catch (error) {\n                    console.error(`‚ùå Error fetching allowance for spender: ${spender}`, error);\n                }\n            }\n        } catch (error) {\n            console.error(`‚ùå Error creating contract for token: ${tokenAddress}`, error);\n        }\n    }\n\n    console.log(\"‚úÖ ERC-20 Approvals Fetched:\", approvals);\n    return approvals;\n}\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,QAAQ;;AAE/B;AACA,OAAO,eAAeC,iBAAiBA,CAACC,cAAc,EAAEC,YAAY,EAAEC,QAAQ,EAAE;EAC5E,MAAMC,GAAG,GAAG,CAAC,2EAA2E,CAAC;EAEzF,IAAIC,SAAS,GAAG,EAAE;;EAElB;EACA,MAAMC,gBAAgB,GAAG,CACrB,4CAA4C,CAAE;EAAA,CACjD;;EAED;EACA,MAAMC,KAAK,GAAGR,MAAM,CAACS,KAAK,CAACC,UAAU,CAACP,YAAY,CAAC;;EAEnD;EACA,MAAMQ,MAAM,GAAGP,QAAQ,CAACQ,SAAS,CAAC,CAAC;EAEnC,KAAK,IAAIC,YAAY,IAAIX,cAAc,EAAE;IACrC,IAAI;MACA,MAAMY,QAAQ,GAAG,IAAId,MAAM,CAACe,QAAQ,CAChCf,MAAM,CAACS,KAAK,CAACC,UAAU,CAACG,YAAY,CAAC;MAAE;MACvCR,GAAG,EACHM,MAAM,CAAC;MACX,CAAC;MAED,KAAK,IAAIK,OAAO,IAAIT,gBAAgB,EAAE;QAClCU,OAAO,CAACC,GAAG,CAAC,uCAAuCF,OAAO,EAAE,CAAC;QAE7D,IAAI;UACA,MAAMG,SAAS,GAAG,MAAML,QAAQ,CAACK,SAAS,CAACX,KAAK,EAAEQ,OAAO,CAAC;UAC1D,IAAIG,SAAS,GAAG,CAAC,EAAE;YACfb,SAAS,CAACc,IAAI,CAAC;cACXN,QAAQ,EAAED,YAAY;cACtBQ,IAAI,EAAE,QAAQ;cACdL,OAAO,EAAEA,OAAO;cAChBM,MAAM,EAAEH,SAAS,CAACI,QAAQ,CAAC;YAC/B,CAAC,CAAC;UACN;QACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;UACZP,OAAO,CAACO,KAAK,CAAC,2CAA2CR,OAAO,EAAE,EAAEQ,KAAK,CAAC;QAC9E;MACJ;IACJ,CAAC,CAAC,OAAOA,KAAK,EAAE;MACZP,OAAO,CAACO,KAAK,CAAC,wCAAwCX,YAAY,EAAE,EAAEW,KAAK,CAAC;IAChF;EACJ;EAEAP,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEZ,SAAS,CAAC;EACrD,OAAOA,SAAS;AACpB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}